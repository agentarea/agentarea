{{- if .Values.worker.enabled }}
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "agentarea.fullname" . }}-worker-env
  labels:
    {{- include "agentarea.labels" . | nindent 4 }}
    app.kubernetes.io/component: worker
data:
  # Database configuration
  POSTGRES_HOST: "{{ .Release.Name }}-postgresql"
  POSTGRES_PORT: "{{ .Values.global.database.port }}"
  POSTGRES_DB: "{{ .Values.global.database.database }}"

  # Redis configuration
  REDIS_HOST: "{{ .Release.Name }}-redis-master"
  REDIS_PORT: "{{ .Values.global.redis.port }}"

  # Temporal/Workflow configuration
  WORKFLOW__USE_WORKFLOW_EXECUTION: "true"
  WORKFLOW__WORKFLOW_ENGINE: "temporal"
  WORKFLOW__TEMPORAL_SERVER_URL: "{{ include "agentarea.fullname" . }}-temporal:{{ .Values.global.temporal.port }}"
  WORKFLOW__TEMPORAL_NAMESPACE: "{{ .Values.global.temporal.namespace }}"
  WORKFLOW__TEMPORAL_TASK_QUEUE: "{{ .Values.global.temporal.taskQueue }}"
  WORKFLOW__TEMPORAL_MAX_CONCURRENT_ACTIVITIES: "10"
  WORKFLOW__TEMPORAL_MAX_CONCURRENT_WORKFLOWS: "5"

  # Task execution
  TASK__ENABLE_DYNAMIC_ACTIVITY_DISCOVERY: "true"

  # Environment
  DEBUG: "false"
  ENVIRONMENT: "production"
{{- end }}
